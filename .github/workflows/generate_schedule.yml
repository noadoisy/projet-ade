name: G√©n√©ration EDT Statique

on:
  # D√©clench√© tous les jours √† 22h00 UTC (23h00 ou 00h00 heure fran√ßaise)
  schedule:
    - cron: '0 22 * * *'
  # Permet de d√©clencher l'Action manuellement depuis l'onglet Actions
  workflow_dispatch:

permissions:
  # üõë C'EST LE BLOC CRITIQUE : Autorise l'Action √† √©crire dans le d√©p√¥t (pour cr√©er data.json)
  contents: write 

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout du d√©p√¥t
        uses: actions/checkout@v4

      - name: Configuration de Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: Installer les d√©pendances
        run: pip install -r requirements.txt
        
      - name: Ex√©cuter le script de parsing et de g√©n√©ration
        run: python parser.py

      - name: Commit et Push de data.json
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # Seul le nouveau fichier data.json sera commit√©
          file_pattern: data.json
          commit_message: "ü§ñ Mise √† jour automatique de l'EDT [skip ci]"